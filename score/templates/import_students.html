{% extends 'base.html' %}

{% block content %}
<div class="card-header">
  <h1 class="card-title">
    <i class="fas fa-upload"></i>
    Import Students from Excel
  </h1>
</div>

<div style="max-width: 600px; margin: auto;">
  {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="form-group">
      <label for="id_file" class="form-label">
        <i class="fas fa-file-excel"></i>
        Upload Excel File
      </label>
      <div class="file-upload">
        <input type="file" name="file" id="fileInput" accept=".xlsx, .xls" required hidden>
        <label for="fileInput" class="file-label">
          <i class="fas fa-cloud-upload-alt"></i>
          Choose Excel File
        </label>
        <span id="fileName" class="file-name">No file chosen</span>
      </div>      
    </div>

    <div style="text-align: center;">
      <button type="submit" class="btn">
        <i class="fas fa-upload"></i>
        Upload & Import
      </button>
    </div>
  </form>

  <div class="info-box">
    <h3>
      <i class="fas fa-info-circle"></i>
      Expected Excel Format
    </h3>
    <p>Your Excel file should have the following columns in the first row:</p>
    <ul style="padding-left: 1.5rem; margin: 1rem 0;">
      <li><code>Full Name</code> - Student's complete name</li>
      <li><code>Matric Number</code> - Student's matriculation number</li>
      <li><code>Project Topic</code> - Title of their project</li>
      <li><code>Department</code> - Academic department</li>
    </ul>
    <div style="background: var(--primary-200); padding: 1rem; border-radius: var(--radius-md); margin-top: 1rem;">
      <p style="margin: 0; font-weight: 600;">
        <i class="fas fa-lightbulb"></i>
        <strong>Important:</strong> The first row should contain these headers exactly as shown above. Data should start from the second row.
      </p>
    </div>
  </div>
</div>
{% endblock %}
